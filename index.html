<!DOCTYPE html>
<html>
  <head>
    <title>Socket.IO chat app</title>

    <style>
      body {
        margin: 0;
        padding-bottom: 3rem;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
      }

      header {
        text-align: center;
        background: sandybrown;
        font-family: fantasy;
        font-size: xxx-large;
        border-radius: 7px;
        color: crimson;
      }
     
      #message > :nth-child(odd) {
        background: #efefef;
      }
    </style>
  </head>
  <body>
    <header>Welcome to Chat App</header>

    <script src="/socket.io/socket.io.js"></script>
    <script>
    var socket = io();
    var user;
    var messages = document.getElementById("message");
 
    function setUsername(){
       socket.emit('setUsername', document.getElementById('name').value);
    };
 
    socket.on('userExists', function(data){
       document.getElementById('error-container').innerHTML = data;
    });
    socket.on('userSet', function(data){
       user = data.username;
       document.body.innerHTML = '<h1> Welcome ' + user +'</h1>\<input type="text" id="message">\
       <button type="button" name="button" onclick="sendMessage()">Send</button>\
       <div id="message-container"></div>';
    });

    function sendMessage(){
       var msg = document.getElementById('message').value;
       if(msg){
          socket.emit('msg', {message: msg, user: user});
       }
    }
    socket.on('newmsg', function(data){
       if(user){
          document.getElementById('message-container').innerHTML +='<div><b>' + data.user + '</b>: ' + data.message + '</div>'
       }
    })

    socket.on("broadcast", function (data) {
              
               const para = document.createElement("p");
para.innerText = data.description;
document.body.appendChild(para);
       
      });
 </script>
 <body>

    <div id="error-container"></div>
    <input id="name" type="text" name="name" value="" placeholder="Enter your name!">
    <button type="button" name="button" onclick="setUsername()">Let me chat!</button>
 </body>
</html>
